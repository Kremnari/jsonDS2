<template bindable="def, types, addField, signaler">
  <h5>${def.$name}</h5>
  <div note="define new field">
    New:<input type="text" value.bind="newField">
    Order: <input type="number" value.bind="newFieldOrder" min="0" step="1" max="100"><br>
    Base:
    <select value.bind="fieldBase" change.delegate="signaler.signal('defUpdate')">
      <option repeat.for="type of types" model.bind="type">${type.$name}</option>
    </select>
    SubType:
    <select value.bind="fieldSubtype" if.bind="fieldBase & signal:'defUpdate'">
      <option model.bind="undefined">*base*</option>
      <option repeat.for="subT of fieldBase.$subTypes | objectValues & signal:'defUpdate'" model.bind="subT">${subT.$name}</option>
    </select>
    <div if.bind="fieldSubtype.$params">
      <div repeat.for="param of fieldSubtype.$params | objectValues">
        ${param.$name}
      </div>
    </div>
    <button click.delegate="addField({ param:
      {$name: newField, $order: newFieldOrder, $type:fieldBase.$name, $subType:fieldSubtype.$name, $params:{}}
    })">Add</button>
  </div>
  <div repeat.for="field of def.$fields | objectValues | sorter:'$order':'ascending' & signal:'defUpdate'">
    ${field.$name}
  </div>
</template>
