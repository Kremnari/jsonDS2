<template>
  <require from="app.css"></require>
  <require from="resources/elements/typeFields/selector.html" as="field-selector"></require>
  <require from="resources/value-converters/objectValues"></require>
  <require from="resources/viewSections/typeEditor.html" as="type-editor"></require>
  <nav>
    <button click.delegate="loadProject()">Load...</button>
    <button click.delegate="saveProject()">Save...</button>
  </nav>
  <div class="content">
    <section id="tablesList">
      <h4>Table/Object List</h4>
      <div note="add new static content table">
        <input type="text" value.bind="newTable"></input>
        <button click.delegate="editTableSchema(newTable)">+&gt;</button>
      </div>
      <div repeat.for="t of jDS2.tables_list" if.bind="jDS2">
        <span click.delegate="showTableContent(t.$name)">${t.$name}</span>
        <span click.delegate="editTableSchema(t.$name)">&#9998;</span>
      </div>
    </section>
    <section id="editorArea" if.bind="editor.as">
      <section if.bind="editor.as == 'list'">
        <div>
          Add new Name:
          <input type="text" value.bind="newContentName"></input>
          <button click.delegate="addNewContentItem(newContentName)">+</button>
        </div>
        <ul>
          <li repeat.for="contentItem of editor.list | objectValues" click.delegate="editContentItem(contentItem)">
            ${contentItem.name}
          </li>
        </ul>
        <div id="CIEditor" if.bind="editor.CIEdit">
          ${editor.CIEdit.$name}
          Add new Field:
          <select name="types" value.bind="newFieldType">
            <option repeat.for="type of jDS2.types_list" model.bind="type">${type.$name}</option>
          </select>
          <input type="text" value.bind="newFieldName">name</input>
          <button click.delegate="addField(newFieldName, newFieldType)">+</button>
          <div repeat.for="prop of editor.schema.$fields">
            ${prop.$name} - ${prop.$type}<input type="text" value.bind="editor.CIEdit[prop.$name]"></input>
          </div>
          <button click.delegate="storeContentItem()">Store</button>
          <button click.delegate="editor.CIEdit = null">Cancel</button>
        </div>

      </section>
      <section if.bind="editor.as == 'editTable'">
        <field-selector repeat.for="field of editor.schema.$fields" field.bind="field"></field-selector>
      </section>
      <section
        as-element="type-editor"
        type.bind="jds2.editor.schema"
        sub-type-of.bind="jds2.editor.subTypeOf"
        >
      </section>
      <div if.bind="editor.as=='editType'">Type EditorX</div>
      <button click.delegate="editorCancel()">Cancel</button>
      <button click.delegate="editorSave()">Save</button>
    </section>
    <section id="typesList">
      <h4>Types List</h4>
      <div note="add new type">
        <input type="text" value.bind="newTypeName"></input>
        <button click.delegate="editTypeOf(newTypeName)">+</button>
      </div>
      <div repeat.for="type of jDS2.types_list" if.bind="jDS2">
        <span click.delegate="editTypeOf(type.$name)">${type.$name}</span>
        <div repeat.for="subT of type.$subTypes | objectValues" if.bind="type.$subTypes">
          <span click.delegate="editTypeOf(type.$name, subT)">&nbsp;-&nbsp;${subT.$name}</span>
        </div>
      </div>
    </section>
    <section id="somethingsomethingdarkside">

    </section>
  </div>
</template>
